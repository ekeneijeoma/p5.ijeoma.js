<head>
    <style>
    body {
        padding: 0;
    }
    canvas {
        position: absolute;
        left: 0;
        top: 0;
        z-index: -100
    }
    </style>
</head>

<body>
    <button id="three">Play</button>
    <button id="stop">Stop</button>
    <button id="time"></button>
    <button>Click and drag left to right to scrub</button>

    <script language="javascript" src="js/p5.js"></script>
    <script language="javascript" src="js/ijeomamotion.js"></script>
    <script language="javascript" src="../build/p5.ijeomamotion.js"></script>
    <script language="javascript">
    // var angles = [30, 10];
    var sqPoint, sqSize, sqScale, sqColor, bgColor;
    var sqPoints = [];
    var sqSequence;

    var txSize;

    function setup() {
        createCanvas(windowWidth, windowHeight);
        // rectMode(CENTER)

        bgColor = color(0);
        sqColor = randomColor();

        txSize = height - height / 2;

        sqScale = 1;
        sqSize = height - height / 3;
        sqPoints = [
            createVector(0, 0),
            createVector(sqSize, 0),
            createVector(sqSize, sqSize),
            createVector(0, sqSize),
            createVector(0, 0)
        ];

        sqPoint = createVector(0, 0);

        frames();
        sqSequence = beginSequence();
        easing(Quad.Out)
        tween(this, 'sqPoint', sqPoints[1], 25)
        relative();
        tween(this, 'sqPoint', sqPoints[2], 25)
        tween(this, 'sqPoint', sqPoints[3], 25)
        tween(this, 'sqPoint', sqPoints[0], 25)
        easing(Bounce.InOut);
        tween(this, 'sqScale', 3, 50).relative()
        endSequence();
        repeat();
        onRepeat(function() {
            bgColor = sqColor;
            sqColor = randomColor();
        })
        play();

        textAlign(CENTER)
        textSize(txSize);

        strokeWeight(5);
    }

    function draw() {
        background(bgColor);

        push();
        translate(width / 2 - sqSize / 2 * sqScale, height / 2 - sqSize / 2 * sqScale)
        scale(sqScale)

        var j = sqSequence.getIndex();

        stroke(sqColor);

        if (sqSequence.getTime() > 1)
            if (j < 4) {
                noFill();
                beginShape();
                for (var i = 0; i <= j; i++)
                    vertex(sqPoints[i].x, sqPoints[i].y)
                endShape();

                line(sqPoints[j].x, sqPoints[j].y, sqPoint.x, sqPoint.y)
            } else {
                fill(sqColor);
                rect(0, 0, sqSize, sqSize)
            }
        pop();

        noStroke()
        fill(sqColor);
        text(sqSequence.getRepeatTime() + 1, width / 2, height / 2 + txSize / 2 - 100);

        document.getElementById('time').innerHTML = sqSequence.getTime() + " / " + sqSequence.getDuration();
    }

    function randomColor() {
        return color(random(255), random(255), random(255))
    }
    </script>
</body>
