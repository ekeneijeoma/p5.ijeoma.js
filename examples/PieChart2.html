<script language="javascript" src="p5.js"></script>
<script language="javascript" src="../build/ijeomamotion.js"></script>
<script language="javascript">
// var angles = [30, 10];
var angles = [30, 10, 45, 35, 60, 38, 75, 67];
var rotation = 270;
var pieArcs = [];
var x = 0;
function setup() {
    createCanvas(720, 400);
    noStroke();
    // angleMode(DEGREES);

    var lastAngle = 0;
    for (var i = 0; i < angles.length; i++) {
        var gray = (i < 0) ? 255 : map(i, 0, angles.length, 0, 255);
        pieArcs.push(new PieArc(i, width / 2, height / 2, 0, 300, radians(angles[i]), lastAngle, gray, 255));
        lastAngle += angles[i];
    }

    s = new MOTION.Sequence();

    var a = rotation;
    var d = 15;

    for (var i = 0; i < pieArcs.length; i++) {
        var pa = pieArcs[i]
        a -= (i > 0) ? (angles[i - 1] / 2 + angles[i] / 2) : angles[i] / 2;

        // s.add(new MOTION.Tween(this, 'rotation', a, d).relative());
        // s.add(new MOTION.Tween(pa, d).add('offset', 0).add('alpha', 255)); 
        s.add(new MOTION(d));
    }

    // s.setTimeScale(5).play()
    s.play()
    // s.seek(0);
}

function draw() {
    background(100);

    text(s.getTime(), 25, 25)
    text(s.get(0).getTime(), 25, 50)
    text(s.get(1).getTime(), 25, 75)
    // text(s.getTime(), 25, 100)
    // text(s.get(0).get(0).getPosition(), 25, 50)

    // rect(x,height/2,10,10)

    push();
    for (var i = 0; i < pieArcs.length; i++)
        pieArcs[i].draw();
    pop();
}

function mousePressed() {
    s.pause();
}

function mouseReleased() {
    // s.resume();
}

function mouseDragged() { 
    s.seek(mouseX / width)
}

function keyTyped() {
    if (key == 'a')
        s.pause();
    else if (key == 's')
        s.resume();
    else if (key == 'd')
        s.play();
    else if (key == 'f')
        s.stop();
}
PieArc = function(id, x, y, offset, d, a1, a2, c, a) {
    this.id = id;
    this.x = x;
    this.y = y;
    this.offset = offset;
    this.d = d;
    this.a1 = a1;
    this.a2 = a2;
    this.color = c;
    this.alpha = a;
    this.draw = function() {
        // stroke(255,this.alpha);
        // fill(0,this.alpha) 
        noStroke()
        fill(this.color, this.alpha)
        push();
        translate(this.x, this.y)
        rotate(rotation + this.a2)
        translate(this.offset * cos(this.a1), this.offset * sin(this.a1))
        arc(0, 0, this.d, this.d, 0, (this.a1), PIE);
        pop();
    };
    return this;
}
</script>
<style>
body {
    padding: 0;
}
</style>
<!-- this line removes any default padding -->
</head>

<body>
</body>